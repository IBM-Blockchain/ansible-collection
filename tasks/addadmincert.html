<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adding an administrator certificate &mdash; Ansible Collection  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Enable Hyperledger Fabric v2.x capabilities" href="enable-fabricv2-capability.html" />
    <link rel="prev" title="Deploying a smart contract" href="../tutorials/deploying.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Ansible Collection
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrating-v12-v2.html">Migrating from v1.2 to version 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/oss-installing.html">Installing Open Source Hyperledger Fabric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/hlfsupport-installing.html">Installing IBM Support for Hyperledger Fabric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/installing.html">Installing the IBM Blockchain Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/building.html">Building a network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/joining.html">Joining a network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/deploying.html">Deploying a smart contract</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tasks</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Adding an administrator certificate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#before-you-start">Before you start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cloning-the-repository">Cloning the repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="#editing-the-variable-file">Editing the variable file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-the-organization">Updating the organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-the-system-channel">Updating the system channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-the-channels">Updating the channels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="enable-fabricv2-capability.html">Enable Hyperledger Fabric v2.x capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="haca.html">Creating a highly available Certificate Authority</a></li>
<li class="toctree-l1"><a class="reference internal" href="intermediateCA.html">Creating an Intermediate Certificate Authority</a></li>
<li class="toctree-l1"><a class="reference internal" href="update-channel-parameters.html">Updating channel parameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roles.html">Roles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Getting support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ansible Collection</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Adding an administrator certificate</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/IBM-Blockchain/ansible-collection/blob/main/docs/source/tasks/addadmincert.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="adding-an-administrator-certificate">
<h1>Adding an administrator certificate<a class="headerlink" href="#adding-an-administrator-certificate" title="Permalink to this heading"></a></h1>
<p>A organization in Hyperledger Fabric has one or more administrators that are able to perform administrative actions such as installing a smart contract onto a peer, or editing channel configuration.</p>
<p>When NodeOU support is enabled for an organization (the default in IBM Blockchain Platform), any enrolled identity with a type of <code class="docutils literal notranslate"><span class="pre">admin</span></code> is automatically recognized as an administrator for that organization. If that enrolled identity expires, or is revoked, then you can just enroll a new identity and that new identity will also be automatically recognized as an administrator for that organization.</p>
<p>However, if NodeOU support is disabled for an organization, then the definition of that organization must specify an explicit list of enrolled identities which will be recognized as administrators. If you need to enroll a new identity, then you must add that new identity to the list of administrators for the organization before it can be recognized as an administrator.</p>
<p>The list of administrators for an organization is stored in multiple places:</p>
<blockquote>
<div><ul class="simple">
<li><p>The organization’s definition that is stored in the IBM Blockchain Platform console.</p></li>
<li><p>The organization’s MSP that is stored in the ordering service system channel, as either an ordering service administrator or a member of the consortium.</p></li>
<li><p>The organization’s MSP that is stored in all channels that the organization is a member of.</p></li>
<li><p>The peer or ordering service nodes file system.</p></li>
</ul>
</div></blockquote>
<p>This task guide walks you through the process of adding a new administrator certificate to an existing organization. You should only follow this task guide if NodeOU support is disabled for the organization.</p>
<section id="before-you-start">
<h2>Before you start<a class="headerlink" href="#before-you-start" title="Permalink to this heading"></a></h2>
<p>This task guide assumes that you have installed Ansible and the IBM Blockchain Platform collection for Ansible, and are familiar with how to use these technologies.</p>
</section>
<section id="cloning-the-repository">
<h2>Cloning the repository<a class="headerlink" href="#cloning-the-repository" title="Permalink to this heading"></a></h2>
<p>This task guide uses a set of example playbooks which are stored in a GitHub repository. You must clone this GitHub repository in order to run the playbooks locally:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/IBM-Blockchain/ansible-collection.git
</pre></div>
</div>
</div></blockquote>
<p>After cloning the GitHub repository, you must change into the examples directory for this task guide:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd ansible-collection/examples/add-admin-cert
</pre></div>
</div>
</div></blockquote>
</section>
<section id="editing-the-variable-file">
<h2>Editing the variable file<a class="headerlink" href="#editing-the-variable-file" title="Permalink to this heading"></a></h2>
<p>You need to edit the variable file <code class="docutils literal notranslate"><span class="pre">vars.yml</span></code>. This file is used to pass information about your network into the example Ansible playbooks.</p>
<p>The first set of values that you must set depend on whether the organization is using the IBM Blockchain Platform on IBM Cloud, or the IBM Blockchain Platform software:</p>
<ul class="simple">
<li><p>If the organization is using IBM Blockchain Platform on IBM Cloud:</p>
<ol class="arabic simple">
<li><p>Create service credentials for the IBM Blockchain Platform service instance, if they have not been created already.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">api_endpoint</span></code> to the value of <code class="docutils literal notranslate"><span class="pre">api_endpoint</span></code> specified in the service credentials.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">api_authtype</span></code> to <code class="docutils literal notranslate"><span class="pre">ibmcloud</span></code>.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">api_key</span></code> to the value of <code class="docutils literal notranslate"><span class="pre">api_key</span></code> specified in the service credentials.</p></li>
<li><p>Note that you do not need to specify a value for <code class="docutils literal notranslate"><span class="pre">api_secret</span></code>.</p></li>
</ol>
</li>
<li><p>If the organization is using IBM Blockchain Platform software:</p>
<ol class="arabic simple">
<li><p>Determine the URL of your IBM Blockchain Platform console.</p></li>
<li><p>Determine the API key and secret you use to access your IBM Blockchain Platform console. You can also use a username and password instead of an API key and secret.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">api_endpoint</span></code> to the URL of your IBM Blockchain Platform console.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">api_authtype</span></code> to <code class="docutils literal notranslate"><span class="pre">basic</span></code>.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">api_key</span></code> to your API key or username.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">api_secret</span></code> to your API secret or password.</p></li>
</ol>
</li>
</ul>
<p>The second set of values must always be set:</p>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">ordering_service_name</span></code> to the name of the ordering service, for example <code class="docutils literal notranslate"><span class="pre">Ordering</span> <span class="pre">Service</span></code>.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">organization_name</span></code> to the name of the organization.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">organization_msp_id</span></code> to the MSP ID of the organization.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">organization_old_admin_identity</span></code> to the path of a JSON identity file containing the identity of the old or current organization administrator.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">organization_new_admin_identity</span></code> to the path of a JSON identity file containing the identity of the new organization administrator.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">channel_names</span></code> to an array of channel names that need to be updated. Do not include the system channel name in this value.</p></li>
</ul>
<p>The final set of values must only be set if the organization being updated is a member of the ordering service consortium, but is not an administrator of the ordering service:</p>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">ordering_service_admin_identity</span></code> to the path to a JSON identity file containing the identity of an ordering service administrator.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">ordering_service_admin_msp_id</span></code> to the MSP ID of the ordering service administrator.</p></li>
</ul>
</section>
<section id="updating-the-organization">
<h2>Updating the organization<a class="headerlink" href="#updating-the-organization" title="Permalink to this heading"></a></h2>
<p>The first step in this task is to update the organization’s definition that is stored in the IBM Blockchain Platform console. It is important to keep the organization in the IBM Blockchain Platform console up to date, as this is used when performing various operational tasks, for example creating a new peer or ordering service node.</p>
<p>Review the example playbook <a class="reference external" href="https://github.com/IBM-Blockchain/ansible-collection/blob/main/examples/add-admin-cert/01-update-organization.yml">01-update-organization.yml</a>, then run it as follows:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ansible-playbook 01-update-organization.yml
</pre></div>
</div>
</div></blockquote>
<p>Ensure that the example playbook completed successfully by examining the <code class="docutils literal notranslate"><span class="pre">PLAY</span> <span class="pre">RECAP</span></code> section in the output from Ansible.</p>
</section>
<section id="updating-the-system-channel">
<h2>Updating the system channel<a class="headerlink" href="#updating-the-system-channel" title="Permalink to this heading"></a></h2>
<p>The system channel for an ordering service contains the definition of all of the organizations that are in the ordering service consortium and all of the organizations that are administrators of the ordering service. If the organization being updated is a member of the ordering service consortium, or an administrator of the ordering service, then you must update the system channel.</p>
<p>If the organization being updated is a member of the ordering service consortium, then it is important to keep the organization in the ordering service consortium up to date, as this is used when creating new channels on the ordering service. Because the consortium is managed by an ordering service administrator, you must have access to an identity for an ordering service administrator in order to complete this step.</p>
<p>If the organization being updated is an administrator of the ordering service, then you must update the definition in the system channel in order to administer the ordering service with the new administrator certificate.</p>
<p>Depending on the role of the organization being updated, perform the appropriate step:</p>
<p><strong>If the organization is a member of the ordering service consortium</strong></p>
<blockquote>
<div><p>Review the example playbook <a class="reference external" href="https://github.com/IBM-Blockchain/ansible-collection/blob/main/examples/add-admin-cert/02-update-syschannel-member.yml">02-update-syschannel-member.yml</a>, and then run it as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ansible-playbook 02-update-syschannel-member.yml
</pre></div>
</div>
<p>Ensure that the example playbook completed successfully by examining the <code class="docutils literal notranslate"><span class="pre">PLAY</span> <span class="pre">RECAP</span></code> section in the output from Ansible.</p>
</div></blockquote>
<p><strong>If the organization is an administrator of the ordering service</strong></p>
<blockquote>
<div><p>Review the example playbook <a class="reference external" href="https://github.com/IBM-Blockchain/ansible-collection/blob/main/examples/add-admin-cert/03-update-syschannel-admin.yml">03-update-syschannel-admin.yml</a>, and then run it as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ansible-playbook 03-update-syschannel-admin.yml
</pre></div>
</div>
<p>Ensure that the example playbook completed successfully by examining the <code class="docutils literal notranslate"><span class="pre">PLAY</span> <span class="pre">RECAP</span></code> section in the output from Ansible.</p>
</div></blockquote>
</section>
<section id="updating-the-channels">
<h2>Updating the channels<a class="headerlink" href="#updating-the-channels" title="Permalink to this heading"></a></h2>
<p>The final step in this task is to update the organization’s definition that is stored in all channels that the organization is a member of. This also applies for organizations that are ordering service administrators, as a copy of the definition of an organization that is n ordering service administrator is stored in each channel.</p>
<p>If you do not complete this step, the new administrator certificate will not be recognized as an administrator for this organization in these channels.</p>
<p>Depending on the role of the organization being updated, perform the appropriate step:</p>
<p><strong>If the organization is not an administrator of the ordering service</strong></p>
<blockquote>
<div><p>Review the example playbook <a class="reference external" href="https://github.com/IBM-Blockchain/ansible-collection/blob/main/examples/add-admin-cert/04-update-channels-member.yml">04-update-channels-member.yml</a>, then run it as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ansible-playbook 04-update-channels-member.yml
</pre></div>
</div>
<p>Ensure that the example playbook completed successfully by examining the <code class="docutils literal notranslate"><span class="pre">PLAY</span> <span class="pre">RECAP</span></code> section in the output from Ansible.</p>
</div></blockquote>
<p><strong>If the organization is an administrator of the ordering service</strong></p>
<blockquote>
<div><p>Review the example playbook <a class="reference external" href="https://github.com/IBM-Blockchain/ansible-collection/blob/main/examples/add-admin-cert/05-update-channels-admin.yml">05-update-channels-admin.yml</a>, then run it as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ansible-playbook 05-update-channels-admin.yml
</pre></div>
</div>
<p>Ensure that the example playbook completed successfully by examining the <code class="docutils literal notranslate"><span class="pre">PLAY</span> <span class="pre">RECAP</span></code> section in the output from Ansible.</p>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials/deploying.html" class="btn btn-neutral float-left" title="Deploying a smart contract" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="enable-fabricv2-capability.html" class="btn btn-neutral float-right" title="Enable Hyperledger Fabric v2.x capabilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright IBM Corporation 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>